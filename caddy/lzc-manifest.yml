name: Caddy
package: com.github.moonfruit.caddy
version: 2.10.0
description: Fast and extensible multi-platform HTTP/1-2-3 web server with automatic HTTPS
license: https://choosealicense.com/licenses/apache-2.0/
homepage: https://github.com/caddyserver/caddy
author: MoonFruit
application:
  subdomain: caddy
  background_task: true
  multi_instance: true
  routes:
    - /=http://caddy
services:
  caddy:
    image: caddy:2.10.0
    binds:
      - /lzcapp/var/config:/config
      - /lzcapp/var/data:/data
      - /lzcapp/run/mnt/home/Config/caddy:/etc/caddy
      - /lzcapp/run/mnt/home/Public:/srv
    setup_script: |
      if [ ! -f /etc/caddy/Caddyfile ]; then
        cat <<EOF > /etc/caddy/Caddyfile
      :80 {
          root * /srv
          file_server browse
          handle /api/shutdown {
              rewrite * /stop_my_self
              reverse_proxy unix//lzcapp/run/lzc-init.sock {
                  header_up Host localhost
              }
          }
      }
      EOF
      fi
